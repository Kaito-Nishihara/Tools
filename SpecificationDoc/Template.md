# 仕様書（機能仕様）: <機能名>

- システム名：<AN1 / 保活 / 〜>
- サブシステム：<Web / Function / Batch / etc>
- 画面/機能ID：<SCR-xxx / FNC-xxx>
- 作成日：YYYY-MM-DD
- 作成者：<name>
- 最終更新日：YYYY-MM-DD
- レビュー：<レビュワー名>
- バージョン：v0.1

---

## 1. 目的
- <この機能で解決したいこと>

## 2. 背景・前提
- 前提：
  - <例：認定申請が作成済みであること>
- 依存：
  - <例：外部認証/別画面/バッチ>
- 対象外：
  - <やらないこと>

## 3. 用語
| 用語   | 意味   |
| ------ | ------ |
| <term> | <desc> |

## 4. スコープ
### 4.1 対象ユーザー
- <例：自治体職員 / 利用者 / 管理者>

### 4.2 対象画面・機能
| 区分 | ID      | 名称     | 備考 |
| ---- | ------- | -------- | ---- |
| 画面 | SCR-xxx | <画面名> |      |
| 機能 | FNC-xxx | <機能名> |      |

---

## 5. 画面仕様（UI）
> 画面がない場合は本章を削除し、「6. API仕様」以降へ

### 5.1 画面概要
- 画面名：<例：個人番号別紙入力>
- URL/ルート：<例：/mnc/besshi>
- 表示条件：<例：制度設定により表示>

### 5.2 画面状態（State）
- 初期表示：
  - <初期値、読込タイミング>
- 編集中：
  - <入力中の状態>
- クローズ/遷移：
  - <モーダル閉じる/画面遷移>

### 5.3 画面項目一覧
| 項目ID | 項目名     | 種別 | 必須  | 入力制約    | 初期値 | 表示条件 | 備考 |
| ------ | ---------- | ---: | :---: | ----------- | ------ | -------- | ---- |
| UI-001 | <氏名>     | Text |   ○   | 最大100文字 |        |          |      |
| UI-002 | <個人番号> | Text |   △   | 12桁/数字   |        |          |      |

### 5.4 操作・イベント一覧（ボタン/リンク/アイコン）
> あなたが言ってた「項目名/概要/対象テーブル/詳細/備考」フォーマット

| 項目名                            | 概要                                                     | 対象テーブル                | 詳細                                                                    | 備考                   |
| --------------------------------- | -------------------------------------------------------- | --------------------------- | ----------------------------------------------------------------------- | ---------------------- |
| 「保存」ボタン                    | 入力内容を検証し、OKならモーダルを閉じる                 | <例：AN1.MncIdentityBesshi> | - 検証OK：モーダルを閉じる<br>- 検証NG：エラーメッセージ表示（5.5参照） |                        |
| 「✖」ボタン                       | 入力内容をモーダル表示時点の状態に戻し、モーダルを閉じる | -                           | - 変更破棄して閉じる                                                    |                        |
| 「（n）人目の世帯員追加＋」ボタン | n人目の入力欄を追加表示する                              | -                           | - 追加された行には「氏名」「個人番号」を表示<br>- 最大件数：<n_max>     | 繰り返し表現は 5.6参照 |

### 5.5 バリデーション仕様
#### 5.5.1 ルール一覧
| ルールID | 対象       | 条件                            | NG時メッセージ                                             | 表示場所         | 備考 |
| -------- | ---------- | ------------------------------- | ---------------------------------------------------------- | ---------------- | ---- |
| V-001    | 世帯員1    | 氏名が空                        | 「氏名を入力してください」                                 | 項目下           |      |
| V-002    | 世帯員2..n | 氏名のみ入力 / 個人番号のみ入力 | 「氏名と個人番号は両方入力するか、両方空欄にしてください」 | 行全体 or 項目下 |      |
| V-003    | 個人番号   | 12桁以外/数字以外               | 「個人番号は12桁の数字で入力してください」                 | 項目下           |      |

#### 5.5.2 バリデーションタイミング
- リアルタイム：<あり/なし>
- 保存押下時：<あり>
- フォーカスアウト：<あり/なし>

### 5.6 繰り返し要素（n表記ルール）
- 仕様書上の表記は以下に統一：
  - 表示文言：`（n）人目`（例：`（3）人目の世帯員追加＋`）
  - データのインデックス：`n = 1..N`
  - 項目ID：`UI-Name[n]` / `UI-MyNumber[n]` のように配列表現  
- 最大件数：`N = <数値>`  
- 並び順：`n昇順`

---

## 6. 業務ロジック仕様（画面なしでも必要ならここに）
### 6.1 処理概要（フロー）
1. <例：初期表示時に既存データ取得>
2. <例：保存押下で入力検証>
3. <例：OKならDB更新して画面を閉じる>

### 6.2 ルール（条件分岐）
| ルールID | 条件                       | 結果     |
| -------- | -------------------------- | -------- |
| B-001    | <例：世帯員1が未入力>      | 保存不可 |
| B-002    | <例：世帯員2..nが両方空欄> | OK       |

---

## 7. API仕様（バックエンドがある場合）
### 7.1 API一覧
| API名  | メソッド | パス     | 認証 | 概要             |
| ------ | -------- | -------- | ---- | ---------------- |
| <保存> | POST     | /api/... | 要   | 入力データを保存 |

### 7.2 API詳細：<API名>
#### Request
- Header：
  - Authorization: Bearer <token>
- Body：
```json
{
  "ninteiShinseiId": 0,
  "members": [
    { "index": 1, "name": "山田 太郎", "myNumber": "123456789012" }
  ]
}
